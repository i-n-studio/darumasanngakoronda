# ゲーム仕様書 — だるまさんがころんだ

最終更新: 2025年11月18日

## 一、概要
- タイトル: だるまさんがころんだ
- ジャンル: モバイル（スマートフォン/タブレット）向けのセンサーアクション + PC対応
- プラットフォーム: iOS / Android / PC (ブラウザ), Monaca/Cordovaを用いたビルド

## 二、ゲームコンセプト
懐かしい遊び「だるまさんがころんだ」を傾きセンサーを使ったバランスチャレンジに昇華。プレイヤーは端末の傾きを使い、鬼が振り向いたときに止まってバランスを維持する。

## 三、ターゲット
- カジュアルゲーマー
- リプレイ性を好むコアゲーマー

## 四、コントロール
- 進むボタン（画面下部）: 長押しで前進。
- 傾き（傾斜）：端末を傾けることで画面下部のドットを動かし、セーフエリアへ維持する。
- 隠し機能：端末を大きく振るとHellモードがアンロックされる（Monaca/実機で挙動確認）

## 五、ゲームフロー
1. Safe（安全状態）: 鬼が背中を向けている状態でプレイヤーは長押しで前へ進む。
2. Preturn（予兆）: 鬼が振り向く兆候が起き、プレイヤーと背景に小さな揺れや視覚エフェクトが発生。
3. Danger（危険）: 鬼が振り向いたタイミング。プレイヤーは進行を止める必要あり。
4. Balanceチャレンジ: Danger時にプレイヤーが止まっていた場合、バランスチャレンジが発生。指定時間、ドットを指定エリアに保持し続けることで成功。
5. 成功: 次回 Safe での移動速度が増す（バフ）。
6. 失敗: 次回移動速度が下がる（デバフ）。ライフが減る可能性あり。
7. ゴール: 距離が0になったら勝利。ライフが0になったらゲームオーバー。

## 六、難易度
- Easy: Balancing が発生しない or セーフエリアが大きい。
- Normal: 基本ルール
- Hard: セーフエリアが小さく、維持時間が短い
- Hell: 隠しモード、セーフエリアが非常に小さい／時間が短い／ペナルティ大

## 七、バランスチャレンジ（詳細）
- UI: 画面下部にセンサーUIを表示。中央に白いドットが動き、指定された緑色のセーフエリアを維持する。
- セーフエリアはゆっくり移動しており、端末を机に置いて回避する方法を防ぐ。
- 成功条件: 設定された時間（duration）だけドットがセーフエリア内に収まった場合
- 失敗条件: 一定時間内に要求を満たせない場合
- 成功時の効果: 次の Safe 状態で移動が速くなる（時間限定）
- 失敗時の効果: 次の Safe で移動が遅くなる、ライフ減少

## 八、UI・デザイン
- ドット絵ピクセルアートでRetroなテイスト
- 画面: 上=ゲームフィールド（プレイヤーと鬼）、中央=ステータス、下=操作（センサーUI + 進むボタン）
- デバッグパネル: roll/pitch の可視化、パラメータ調整可能（開発向け）

## 九、サウンド
- WebAudio API を採用
- BGM、効果音（成功・失敗・足音）をサポート
- BGMはゲーム状況に応じて速度・ピッチを変更してフィードバックを与える

## 十、技術要件
- Cordova/Monaca プロジェクト形式
- 必要プラグイン
  - cordova-plugin-device-motion (devicemotion API, or native equivalent)
  - cordova-plugin-device-orientation (deviceorientation API)
  - cordova-plugin-shake (optional - for Hell unlock)
- iOS の動作確認: DeviceMotion permission の実装
- フォールバック: センサー非搭載端末のためにキーボード/スライダーでの代替操作を実装

## 十一、デバッグ・開発ツール
- Debug パネル: センサー値・モード・バランス設定をリアルタイムで調整
- 追加: センサーログの保存を将来的に追加し、動作改善に活かす

## 十二、不正行為対策
- セーフエリアをスライドして機械的に安定させる行為を抑止（定期的に動かす、センサーで静的検出を検出する）
- 振動や急激な加速度変化によるパターン検出（後で追加導入）

## 十三、カスタムモード
- プレイヤーがライフや制限時間、ゴールまでの距離を設定可能
- ハイリスク・ハイリワードの設定も可能にする

## 十四、隠しモード - Hell
- デバイスを激しく振ることでアンロック（未搭載デバイスはメニューから有効化可能）
- Hell は極端なバランスチャレンジ、報酬としてスコア倍率やバッジを付与

## 十五、セーブ・ランキング（将来の予定）
- ローカルにハイスコアを保存
- オンライン: Firebase/PlayFab によるリーダーボードを検討

## 十六、テスト・リリース条件
- センサーが反応しないケースのフォールバック動作が確実になされていること
- iOS/Android でセンサー精度差を吸収する閾値調整を行ったこと
- UIがモバイルでもPCでも操作しやすいこと

## 十七、アセット・リソース
- 8-bit ピクセルアート：プレイヤー、鬼、背景、UIアイコン
- BGM と SFX：効果音(成功/失敗/ボタン)・BGM は短いループに対応したものを用意

## 十八、付録：現在の実装の差分
- 実装済み: 基本ゲームループ、センサー、バランスチャレンジ、Hellのシェイク検出（アンロック）
- まだ必要: スプライト・BGMのファイル差替え、クラウド連携、バランスチューニング

---
作成者: 井上真翔
連絡先: (学校のアカウント)
